const CACHE_NAME="story-app-cache-v1",urlsToCache=["/","/index.html","/manifest.json","/styles/styles.css","/scripts/main.js","/favicon.png","/images/logo.png"];self.addEventListener("install",(t=>{t.waitUntil(caches.open(CACHE_NAME).then((async t=>{for(const e of urlsToCache)try{await t.add(e),console.log(`Cached: ${e}`)}catch(t){console.error(`Gagal cache: ${e}`,t)}})))})),self.addEventListener("fetch",(t=>{const e=new URL(t.request.url);e.origin===location.origin&&e.pathname.startsWith("/v1/stories")?t.respondWith(caches.open(CACHE_NAME).then((async e=>{try{const s=await fetch(t.request);return e.put(t.request,s.clone()),s}catch(s){return await e.match(t.request)||new Response("Offline",{status:503,statusText:"Offline"})}}))):t.respondWith(caches.match(t.request).then((e=>e||fetch(t.request))))})),self.addEventListener("activate",(t=>{const e=[CACHE_NAME];t.waitUntil(caches.keys().then((t=>Promise.all(t.map((t=>{if(!e.includes(t))return caches.delete(t)}))))))})),self.addEventListener("push",(t=>{let e={title:"Story Baru!",options:{body:"Ada story baru yang dibuat.",icon:"/images/logo.png",badge:"/images/logo.png"}};if(t.data)try{e=t.data.json()}catch{e.options.body=t.data.text()}t.waitUntil(self.registration.showNotification(e.title,e.options))}));